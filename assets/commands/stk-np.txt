/* eslint no-unused-vars: "off" */

const Discord = require('discord.js');
const YouTube = require('simple-youtube-api');
const youtube = new YouTube(process.env.API_TOKEN);
const play = require('./stk-play');
const currentQueue = play.queueSongs();

module.exports = {
	name: 'np',
	usage: '<no have parameters>',
	aliases: ['current', 'now'],
	guildOnly: true,
	description: 'Get stalker bot response time',
	execute(message, _args) {
		const { voiceChannel } = message.member;
		console.log(voiceChannel.connection.dispatcher);
		youtube.searchVideos(currentQueue.url, 1)
			.then(results => {
				const ytEmbed = new Discord.RichEmbed()
					.setAuthor('Stalker Music', 'https://i.imgur.com/Xr28Jxy.png')
					.setThumbnail(results[0].thumbnails.high.url)
					.setColor('#7f1515')
					.setTitle('Now Playing')
					.addField('Title', results[0].title, true)
					.addField('Channel', results[0].channel.title, true)
					.addField('Link', `https://youtu.be/${results[0].id}`)
					.setFooter('Powered by Stalker bot', 'https://i.imgur.com/Xr28Jxy.png');
				message.channel.send(ytEmbed);
			}).catch(err => {
				console.log(err);
			});
	},
};